using Newtonsoft.Json;
using Topo.Models.ReportGeneration;
using TopoReportFunction;

namespace TopoReportFunctionTest
{
    [TestClass]
    public class AdditionalAward
    {
        private ReportGenerationRequest _reportGenerationRequest;
        private Function _function;

        [TestInitialize]
        public void SetUp()
        {
            _function = new Function();
            _reportGenerationRequest = new ReportGenerationRequest()
            {
                ReportType = ReportType.AdditionalAwards,
                GroupName = "Epping Scout Group",
                Section = "scout",
                UnitName = "Scout Unit",
                OutputType = OutputType.PDF,
                ReportData = "{\"AwardSpecificationsList\":[{\"id\":\"camper_award_10\",\"name\":\"Camper Award - 10 Nights\",\"additionalAwardSortIndex\":0},{\"id\":\"camper_award_25\",\"name\":\"Camper Award - 25 Nights\",\"additionalAwardSortIndex\":1},{\"id\":\"camper_award_50\",\"name\":\"Camper Award - 50 Nights\",\"additionalAwardSortIndex\":2},{\"id\":\"camper_award_75\",\"name\":\"Camper Award - 75 Nights\",\"additionalAwardSortIndex\":3},{\"id\":\"camper_award_100\",\"name\":\"Camper Award - 100 Nights\",\"additionalAwardSortIndex\":4},{\"id\":\"walkabout_10\",\"name\":\"Walkabout Award - 10km\",\"additionalAwardSortIndex\":5},{\"id\":\"walkabout_50\",\"name\":\"Walkabout Award - 50km\",\"additionalAwardSortIndex\":6},{\"id\":\"walkabout_100\",\"name\":\"Walkabout Award - 100km\",\"additionalAwardSortIndex\":7},{\"id\":\"walkabout_150\",\"name\":\"Walkabout Award - 150km\",\"additionalAwardSortIndex\":8},{\"id\":\"walkabout_200\",\"name\":\"Walkabout Award - 200km\",\"additionalAwardSortIndex\":9},{\"id\":\"walkabout_300\",\"name\":\"Walkabout Award - 300km\",\"additionalAwardSortIndex\":10},{\"id\":\"walkabout_400\",\"name\":\"Walkabout Award - 400km\",\"additionalAwardSortIndex\":11},{\"id\":\"walkabout_500\",\"name\":\"Walkabout Award - 500km\",\"additionalAwardSortIndex\":12},{\"id\":\"first_aid\",\"name\":\"First Aid\",\"additionalAwardSortIndex\":13},{\"id\":\"landcare\",\"name\":\"Landcare\",\"additionalAwardSortIndex\":14},{\"id\":\"their_service_our_heritage\",\"name\":\"Their Service - Our Heritage\",\"additionalAwardSortIndex\":15},{\"id\":\"duke_of_edinburgh_bronze\",\"name\":\"The Duke of Edinburgh's Award (Bronze)\",\"additionalAwardSortIndex\":16},{\"id\":\"duke_of_edinburgh_silver\",\"name\":\"The Duke of Edinburgh's Award (Silver)\",\"additionalAwardSortIndex\":17},{\"id\":\"duke_of_edinburgh_gold\",\"name\":\"The Duke of Edinburgh's Award (Gold)\",\"additionalAwardSortIndex\":18},{\"id\":\"scouts_of_the_world\",\"name\":\"Scouts of the World Award\",\"additionalAwardSortIndex\":19},{\"id\":\"messengers_of_peace\",\"name\":\"Messengers of Peace\",\"additionalAwardSortIndex\":20},{\"id\":\"ses\",\"name\":\"SES\",\"additionalAwardSortIndex\":21},{\"id\":\"language_emblem\",\"name\":\"Language Emblem\",\"additionalAwardSortIndex\":22},{\"id\":\"scout_wings\",\"name\":\"Scout Wings\",\"additionalAwardSortIndex\":23},{\"id\":\"mental_health\",\"name\":\"Mental Health\",\"additionalAwardSortIndex\":24},{\"id\":\"youth_helper\",\"name\":\"Youth Helper\",\"additionalAwardSortIndex\":25},{\"id\":\"international_ambassador\",\"name\":\"International Ambassador Badge\",\"additionalAwardSortIndex\":26},{\"id\":\"champions_for_nature\",\"name\":\"Champions for Nature Challenge\",\"additionalAwardSortIndex\":27},{\"id\":\"tide_turners_plastic\",\"name\":\"Tide Turners Plastic Challenge\",\"additionalAwardSortIndex\":28},{\"id\":\"scouts_go_solar\",\"name\":\"Scouts Go Solar Challenge\",\"additionalAwardSortIndex\":29},{\"id\":\"scouts_for_sdgs\",\"name\":\"SDG Challenge\",\"additionalAwardSortIndex\":30}],\"SortedAdditionalAwardsList\":[{\"MemberName\":\"Alexander Holowinski (4 Nights, 28 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Alexander Holowinski (4 Nights, 28 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Amelia Chung (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Annabella Ronfeldt (7 Nights, 19 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Annabella Ronfeldt (7 Nights, 19 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Bethany Wong (3 Nights, 26 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Bethany Wong (3 Nights, 26 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Cathy Graham (4 Nights, 12 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Cathy Graham (4 Nights, 12 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Chloe Small (3 Nights, 5 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Daniel Chung (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Eric Liu (10 Nights, 33 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Eric Liu (10 Nights, 33 KMs)\",\"AwardId\":\"camper_award_10\",\"AwardName\":\"Camper Award - 10 Nights\",\"AwardSortIndex\":0,\"AwardDate\":\"2020-08-26T00:00:00\",\"PresentedDate\":\"2020-08-26T00:00:00\"},{\"MemberName\":\"Eric Liu (10 Nights, 33 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Ethan Lloyd (9 Nights, 38 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Ethan Lloyd (9 Nights, 38 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"James Alchin (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"James Li (8 Nights, 31 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"James Li (8 Nights, 31 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Jeremy Chim (8 Nights, 24 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Johnny Li (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Jonathan Li (12 Nights, 43 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Jonathan Li (12 Nights, 43 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Joshua Jones (7 Nights, 10 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Katrina Koop (9 Nights, 21 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Katrina Koop (9 Nights, 21 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Lukas Dunn (1 Nights, 32 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Matthew Last (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Peter Xia (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Phoenix Cao (4 Nights, 29 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Phoenix Cao (4 Nights, 29 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Ronit Natarajan (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Sebastien Wookey (36 Nights, 89 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Sebastien Wookey (36 Nights, 89 KMs)\",\"AwardId\":\"camper_award_10\",\"AwardName\":\"Camper Award - 10 Nights\",\"AwardSortIndex\":0,\"AwardDate\":\"2020-08-26T00:00:00\",\"PresentedDate\":\"2020-08-26T00:00:00\"},{\"MemberName\":\"Sebastien Wookey (36 Nights, 89 KMs)\",\"AwardId\":\"camper_award_25\",\"AwardName\":\"Camper Award - 25 Nights\",\"AwardSortIndex\":1,\"AwardDate\":\"2020-08-26T00:00:00\",\"PresentedDate\":\"2020-08-26T00:00:00\"},{\"MemberName\":\"Sebastien Wookey (36 Nights, 89 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Sebastien Wookey (36 Nights, 89 KMs)\",\"AwardId\":\"walkabout_50\",\"AwardName\":\"Walkabout Award - 50km\",\"AwardSortIndex\":6,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Tynn Yam (3 Nights, 26 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Tynn Yam (3 Nights, 26 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Yang Pan (0 Nights, 0 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Zara Williams (12 Nights, 43 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Zara Williams (12 Nights, 43 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Zoe Lloyd (10 Nights, 23 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Zoe Lloyd (10 Nights, 23 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"},{\"MemberName\":\"Zoe Williams (12 Nights, 43 KMs)\",\"AwardId\":\"\",\"AwardName\":\"\",\"AwardSortIndex\":0,\"AwardDate\":null,\"PresentedDate\":null},{\"MemberName\":\"Zoe Williams (12 Nights, 43 KMs)\",\"AwardId\":\"walkabout_10\",\"AwardName\":\"Walkabout Award - 10km\",\"AwardSortIndex\":5,\"AwardDate\":\"2022-04-24T00:00:00\",\"PresentedDate\":\"2022-04-24T00:00:00\"}],\"DistinctAwards\":[\"\",\"camper_award_10\",\"camper_award_25\",\"walkabout_10\",\"walkabout_50\"]}"
            };
            if (!Directory.Exists("TestResults"))
                Directory.CreateDirectory("TestResults");
        }

        [TestMethod]
        public void AdditionalAwards_ToPDF()
        {
            var proxyRequest = new Amazon.Lambda.APIGatewayEvents.APIGatewayProxyRequest();
            proxyRequest.Body = JsonConvert.SerializeObject(_reportGenerationRequest);
            var functionResult = _function.FunctionHandler(proxyRequest, null);
            //Convert Base64String into PDF document
            byte[] bytes = Convert.FromBase64String(functionResult);
            FileStream fileStream = new FileStream(@"TestResults\AdditionalAwards_ToPDF.pdf", FileMode.Create);
            BinaryWriter writer = new BinaryWriter(fileStream);
            writer.Write(bytes, 0, bytes.Length);
            writer.Close();
        }

    }
}
